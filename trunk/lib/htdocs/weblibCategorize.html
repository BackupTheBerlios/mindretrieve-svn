<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/html4/loose.dtd">
<html>
<head>
<title>MindRetrieve - Configuration</title>
<link rel="stylesheet" href="main.css" type="text/css">
<style>
  .error_message {
    color:red;
  }
  #instruction_example {
    margin-top: 0.5ex;
    width: 80%;
    padding: 3px;
    border: thin solid #ccc;
  }

  #category_description {
    width: 95%;
    height: 500px;
    margin-bottom: 1ex;
  }

  #uncategorized {
    width: 95%;
    margin-bottom: 1ex;
  }

</style>
<script>
function close_form() {
    rurl = document.getElementById('return_url');
    window.location = rurl.value;
}

function setHeight() {
    // set category proportion to the window size.
    height = Math.max((window.innerHeight-50)*0.7, 100);
    cd_stylex = document.getElementById('category_description').style;
    cd_stylex.height = height;
    uc_stylex = document.getElementById('uncategorized').style;
    uc_stylex.height = height;
}

function dblclick_uncategorized(e) {
    addTag();
}

function addTag() {
    var selbox = document.getElementById('uncategorized');
    if (selbox.selectedIndex < 0)
        return;
    tag = selbox.value;
    insert_tag(tag);
    selbox.options[selbox.selectedIndex] = null;
}

function insert_tag(tag) {
    txtbox = document.getElementById('category_description');
    v = txtbox.value;
    start = Math.max(txtbox.selectionStart,0);

    // find last indent
    last = v.substring(0,start).lastIndexOf('\n')+1;
    indent = v.substring(last).match(/ */);
    if (!indent) indent = ''

    insert_txt = indent + tag + '\n';

    // insert after next \n
    next = v.indexOf('\n', start);
    if (next < 0) {
        txt = v + insert_txt;
        next = txt.length-1;
    }
    else {
        next += 1;
        txt = v.substring(0,next) + insert_txt + v.substring(next);
        next += insert_txt.length-1;
    }
    txtbox.value = txt;
    txtbox.setSelectionRange(next,next);
    txtbox.focus();
}

function addListeners(e) {
    setHeight();
    var elem = document.getElementById('uncategorized');
    elem.addEventListener('dblclick', dblclick_uncategorized, false);
}

window.addEventListener('load', addListeners, false);
</script>
</head>


<body>
<div node='-con:header' style='width:100%;background-color:#ddd;text-align:center'>--HEADER--</div>

<!-- TAB HEADER -->
<div class='tabHeader'>
&nbsp;
<span class='inactiveTab'><a href='/weblib.tagName'>Tag Name</a></span>
<span class='activeTab'><a href='/weblib.categorize'>Categorize</a></span>
</div>

<!-- main content -->
<form method='post' action='/weblib.categorize'>
<input node='con:return_url' type='hidden' name='return_url' />

<table cellspacing='0' cellpadding='2'>
<tr>


<!-- instruction column -->
<td style='width:20%' valign='top'>
<p>Categorize the tags by editing them in the space in the right.</p>

<p>Put each tag on a line. Insert 2 spaces in front of a tag to mean it
is a subcategory. Add more spaces to mean it is a subcategory of
subcategories. A tag may appears multiple times in a category. Blank lines maybe added for
clarity.</p>

<p>For example:</p>
<pre id='instruction_example'>food
  fish
  fruit
    apple
    orange
  meat

travel
  bus
  train
  airplane</pre>

<p>Tags that are not yet categorized are listed on the right. Add them to the category as you see fit.
</p>
</td>


<!-- filler column -->
<td style='width:3%' ></td>


<!-- editing column -->
<td valign='top'>
<h3>Tag Categories</h3>
<textarea node='con:category_description' id='category_description' name='category_description'>
top
  second
    third
    third2
  second2
</textarea>
<br />
<input class='btn' type='submit' name='action' value='Update' />
<!--<input class='btn' type='reset' name='action' />-->
<input class='btn' type='button' name='action' value='Cancel' onclick='close_form()' />
</td>


<!-- uncategorized column -->
<td style='width:20%' valign='top'>
<h3>Tags to be categorized</h3>
<select id='uncategorized' size='20'>
<option node='rep:uncategorized_tag'>tag1</option>
<option node='rep:uncategorized_tag'>tag2</option>
<option node='rep:uncategorized_tag'>tag3</option>
</select>
<input class='btn' type='button' onclick='addTag();' value='Add' />
</td>

</tr>
</table>
</form>

<div node='-con:footer' style='width:100%;background-color:#ddd;text-align:center'>--footer--</div>

</body>
</html>