<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/html4/loose.dtd">
<html>
<head>
<title>MindRetrieve - Configuration</title>
<link rel="stylesheet" href="/main.css" type="text/css">
<style>
  #content         {
    margin-top: 2ex;
    width: 100%;
  }

  .go_hint          {
    margin-top: 1ex;
    font-size: smaller;
    color: #999;
    float: right;
  }
  .go_hint a        { color: #999}


  /* ------------------------------------------------------------------------
     Category Pane
     ------------------------------------------------------------------------
  */
  #categorytPane        {
    width: 16em;
    padding: 0.2cm;
    border: thin solid #777;
  }
  #categorytPane p     {
    padding: 0.2cm;
    border: thin solid #777;
  }
  #categorytPane ul     {
    list-style-type: none;
    padding: 0;
    margin-left: 0;
    margin-top: 1ex;
  }
  #categorytPane a      {
    color: #000;
    text-decoration: none;
  }
  #categorytPane a:hover{
    text-decoration: underline;
  }
  #categorytPane .toggleSwitch {
    padding-right: 0.3em;
    width: 50px;
    /* invisible border to make the toggle not move when hover */
    border: thin solid #fff;
  }
  #categorytPane .highlight .toggleSwitch {
    padding-right: 0.3em;
    width: 50px;
    /* invisible border to make the toggle not move when hover */
    border: thin solid #fc9;
  }
  #categorytPane .toggleSwitch:hover{
    text-decoration: none;
    border: thin outset #777;
  }
  #categorytPane .MainCat {
    font-size: larger;
    font-weight: bold;
  }
  #categorytPane .subcategories {
  }
  #categorytPane .subcategoriesCollapsed {
    display: none;
  }
  #categorytPane .SubCat1 {
    display: inline;
    font-size: 95%;
    color: #000;
  }
  #categorytPane .SubCat2 {
    display: inline;
    margin-right: 0;
    font-size: 80%;
  }
/*
  #categorytPane .CurrentCat::before { content: "[" }
  #categorytPane .CurrentCat::after  { content: "]" }
  #categorytPane .CurrentCat {
    padding: 0;
    font-weight: bold;
    Xborder: thin outset #777;
    padding-left: 0.2em;
    padding-right: 0.2em;
  }
*/
  #categorytPane .highlight  {
    padding-top: 0.5ex;
    padding-bottom: 0.5ex;
    line-height:150%;
    background-color: #fc9;
  }

  /* the color of CategorySubItems is control via <a>?? */
  #categorytPane .MainCat a    {
    color: #000;
  }
  #categorytPane .SubCat1 a   {
    color: #000;
  }
  #categorytPane .SubCat2 a   {
    color: #777;
  }


  #organizeButton {
    font-size: 85%;
  }


  /* ------------------------------------------------------------------------
     Webitem Pane
     ------------------------------------------------------------------------ */

  #itemPane             {
    padding-left: 1em;
  }

  #no_match_msg {
    padding: 1em;
  }


  .libTable     a       { text-decoration: none; }
  .libTable     a:hover { text-decoration: underline; }
  .libTable .itemHeader a { color:black; }
  .libTableHeader       {
    background-color: #ccc;
  }
  .libTableFooter       {
    background-color: #ccc;
  }

  .libTable             {
    border-collapse: collapse;
  }

  .libTable tr          {
    border-top: thin solid white;
  }

  .libTable td          {
    padding-left: 2px;
    padding-right: 2px;
  }
   /* item table */
  .col1 { width: 2em; }
  .col2 { width: *;}
  .col3 { width: 1.5em;}
  .col4 { width: 1.5em;}
  .col5 { width: 9%;}

  .altrow               {
    background-color: #eee;
  }

  .selectedrow          {
    background-color: #fc9;
  }

  .altselectedrow       {
    background-color: #fc9;
  }
/*
  .altselectedrow td      {
    border-top: thin solid white;
    xborder-bottom: thin solid white;
  }
*/
  .itemHeader           {
    font-weight: bold;
  }
  .itemHeaderSpacer     {
    line-height:150%;
  }
  .itemDescription      {
    float: left;
  }
  .itemTag              {
    float: right;
  }
  .itemSmallLink        {
    font-size:75%;
  }
  .itemSmallLink img    {
    position:relative;
    top:1px;
    border:0;
  }


  /* ------------------------------------------------------------------------

     ------------------------------------------------------------------------ */
  #asyncForm {
    width: 50%;
    height: 20%;
    font-size: small;
    display: none;
  }
</style>

<script>
/*
function webitemKeypressEvent(e) {
    window.status = 'keyCode=' + e.keyCode;
}
*/
function toggleSubCatEvent(e) {
    result = toggleSubCat(this);
    // notify server of the new setting via the asyncForm
    var asyncForm = document.getElementById('asyncForm');
    asyncForm.action = '/weblib/' + result[0];
    var input_cc = document.getElementById('asyncForm.category_collapse');
    input_cc.value = result[1];
    asyncForm.submit();
}

// return [switchElem.id, collapse('on'/'off')]
function toggleSubCat(switchElem) {
    // find the subcategories element
    for (var subcat=switchElem.nextSibling; subcat != null; subcat=subcat.nextSibling) {
        if (subcat.className == 'subcategories') {
            switchElem.innerHTML = '+';
            subcat.className = 'subcategoriesCollapsed';
            return [switchElem.id, 'on'];
        }
        else if (subcat.className == 'subcategoriesCollapsed') {
            switchElem.innerHTML = '-';
            subcat.className = 'subcategories';
            return [switchElem.id, 'off'];
        }
    }
    throw new Error('toggleSubCat subcategories class not found: switchElem.id=' + switchElem.id);
}

function toggleWebitemEvent(e) {
    setWebitemRow(this)
}

function setWebitemRow(checkbox) {
    // set class of parent <tr>
    for (var p=checkbox.parentNode; p.nodeType == 1/*ELEMENT_NODE*/; p=p.parentNode) {
        if (p.tagName.toLowerCase() != 'tr') continue;
        if (checkbox.checked) {
            if (p.className == '') {
                p.className = 'selectedrow';
            }
            else if (p.className == 'altrow') {
                p.className = 'altselectedrow';
            }
        }
        else {
            if (p.className == 'selectedrow') {
                p.className = '';
            }
            else if (p.className == 'altselectedrow') {
                p.className = 'altrow';
            }
        }
        return;
    }
    throw new Error('Cannot not find a parent <tr>: ' + checkbox);

}

function selectAll(cb) {
    var checked = document.getElementById(cb).checked;
    var form = document.getElementById('webpages');
    for (i=0; i < form.elements.length; i++) {
        var elem = form.elements[i];
        if (elem.type == 'checkbox') {
            elem.checked = checked;
            setWebitemRow(elem);
        }
    }
}

function organizeSelected() {
    var count = countSelected();
    if (count == 0) {
        alert('Please select items to be organized.')
        return;
    }
    var form = document.getElementById('webpages');
    form.action = '/weblib.entryOrg';
    var m = document.getElementById('webpages_method');
    m.value = 'GET';
    form.submit();
}

function deleteSelected() {
    var count = countSelected();
    if (count == 0) {
        alert('Please select items to be deleted.')
        return;
    } else {
        if (!confirm('Delete ' + count + ' items selected?'))
            return;
    }
    var form = document.getElementById('webpages');
    form.action = '/weblib.entryOrg';
    var m = document.getElementById('webpages_method');
    m.value = 'DELETE';
    form.submit();
}

function countSelected() {
    var count = 0;
    var form = document.getElementById('webpages');
    for (i=0; i < form.elements.length; i++) {
        elem = form.elements[i];
        if (elem.type != 'checkbox')
            continue;
        name = elem.name;
        if (name.length <= 0)
            continue;
        d0 = name.charAt(0);
        if ((d0 >= '0') && (d0 <= '9') && elem.checked)
            count++;
    }
    return count
}

function onload(e) {
    // attach toggleSubCat event handler
    var catPane = document.getElementById('categorytPane');
    var aElems = catPane.getElementsByTagName('a');
    for (var i=0; i < aElems.length; i++) {
        var elem = aElems[i];
        if (elem.className == 'toggleSwitch') {
            elem.addEventListener('click', toggleSubCatEvent, false);
        }
    }
    // attach event handlers to webitem checkbox
    var tbl = document.getElementById('libTable')
    var checkboxes = tbl.getElementsByTagName('input')
    for (var i=0; i < checkboxes.length; i++) {
        var elem = checkboxes[i];
        // assume element with numeric name is the item checkbox
        if (!isNaN(parseInt(elem.name))) {
            elem.addEventListener('click', toggleWebitemEvent, false);
//            elem.addEventListener('keypress', webitemKeypressEvent, false);
        }
    }
}

window.addEventListener('load', onload, false);

</script>

</head>


<body>

<div node='-con:header' style='width:100%;background-color:#ddd;text-align:center'>--HEADER--</div>

<table id='content' border='0' cellspacing='0' cellpadding='0'>
<tr valign='top'>



<!--categoryPane---------------------------------------------------------->
<td id='categorytPane'>
<ul>
  <ul>
    <span class='SubCat1'><a node='con:rootTag' href='/weblib?tag='>/</a></span><span class='MainCat'><a node='con:defaultTag' href='/weblib?tag='>inbox</a></span>
    <span style='float: right'><input id='organizeButton' type='button' value='Organize' onclick='window.location="/weblib.tagName";' /></span>
  </ul>
  <ul node='rep:catList'>
    <a node='con:toggleSwitch' id='@1' class='toggleSwitch' href='#'>+</a><span class='MainCat'><a node='con:link' href='#'>MainCat</a></span><br />
    <span node='con:subcat' class='subcategoriesCollapsed'>
    <li node='rep:catItem' class='SubCat1'><a node='con:link' href='#'>Sub 1</a></li>
    <li node='rep:catItem' class='SubCat1'><a node='con:link' href='#'>Sub 2</a></li>
    <li node='rep:catItem' class='SubCat2'><a node='con:link' href='#'>Sub 21</a></li>
    <li node='rep:catItem' class='SubCat2'><a node='con:link' href='#' class='highlight'>sub 22</a></li>
    <li node='rep:catItem' class='SubCat1'><a node='con:link' href='#'>Sub 3</a></li>
    </span>
  </ul>
  <ul node='rep:catList'>
    <a node='con:toggleSwitch' id='@2' class='toggleSwitch' href='#'>+</a><span class='MainCat'><a node='con:link' href='#'>MainCat</a></span><br />
    <span node='con:subcat' class='subcategoriesCollapsed'>
    <li node='rep:catItem' class='SubCat1'><a node='con:link' href='#'>Sub 1</a></li>
    <li node='rep:catItem' class='SubCat1'><a node='con:link' href='#'>Sub 2</a></li>
    <li node='rep:catItem' class='SubCat2'><a node='con:link' href='#'>Sub 21</a></li>
    <li node='rep:catItem' class='SubCat2'><a node='con:link' href='#' class='highlight'>sub 22</a></li>
    <li node='rep:catItem' class='SubCat1'><a node='con:link' href='#'>Sub 3</a></li>
    </span>
  </ul>
  <ul node='rep:catList'>
    <a node='con:toggleSwitch' id='@3' class='toggleSwitch' href='#'>-</a><span class='MainCat'><a node='con:link' href='#'>MainCat</a></span><br />
    <span node='con:subcat' class='subcategories'>
    <li node='rep:catItem' class='SubCat1'><a node='con:link' href='#'>Sub 1</a></li>
    <li node='rep:catItem' class='SubCat1'><a node='con:link' href='#' class1='highlight'>Sub 2</a></li>
    <li node='rep:catItem' class='SubCat2'><a node='con:link' href='#'>Sub 21</a></li>
    <li node='rep:catItem' class='SubCat2'><a node='con:link' href='#' class='highlight'>sub 22</a></li>
    <li node='rep:catItem' class='SubCat1'><a node='con:link' href='#'>Sub 3</a></li>
    </span>
  </ul>
</ul>
</td> <!-- categoryPane -->




<!--itemPane-------------------------------------------------------------->
<td id='itemPane'>

<div node='con:no_match_msg' id='no_match_msg'>
    No item found.
</div>

<div node='con:web_items'>
  <div id='crumb'>
      <span node='con:go_hint' class='go_hint'>Go to <a node='con:address' href='#'>website</a>.</span>
  </div>

  <p node='con:tags_matched'>
      Found tags:
      <a node='rep:tag' href='#'>Tag1</a>
      <a node='rep:tag' href='#'>Tag2</a>
  </p>

  <form id='webpages' action='/weblib' method='GET'>
  <input id='webpages_method' type='hidden' name='method' value='' />
  <table id='libTable' width='100%' cellspacing='0' cellpadding='0' class='libTable'>

  <col class='col1' />
  <col class='col2' />
  <col class='col3' />
  <col class='col4' />
  <col class='col5' />

  <!-- header ------------------------------------------------------------------------>
  <tr class='libTableHeader'>
    <td><input id='checkAll_top' type='checkbox' onclick='selectAll("checkAll_top");'></td>
    <td colspan='4' align='right'>
       <input type='button' value='Organize' onclick='organizeSelected();' />
       <input type='button' value='Delete'  onclick='deleteSelected();' />
    </td>
  </tr>

  <!-- webItem ------------------------------------------------------------------------>

  <tr node='con:headerTemplateHolder'>
    <span node='-con:headerTemplate'>
    <td><span class='itemHeaderSpacer'>&nbsp;</span></td>
    <td colspan='4' valign='bottom'>
        <span node='con:prefix' class='itemHeader'>1</span>
        <span class='itemHeader'><a node='con:itemHeader' href='#'>Travel</a></span>
    </td>
    </span>
  </tr>

  <tr node='rep:webItem' class='altrow'>
    <span node='-con:placeHolder'>
    <td><input node='con:checkbox' type='checkbox' name='100' /></td>
    <td>
        <span node='itemDescription' class='itemDescription'>
            <a node='con:itemDescription' href='#' title='MindRetrieve - search your personal web'>this is a long link </a>
        </span>
        <span node='con:itemTag' class='itemTag'>
            <a node='rep:tag' href='#' class='itemSmallLink'>tag1</a>
            <span node="-sep:tag">, </span>
            <a node='rep:tag' href='#' class='itemSmallLink'>tag2</a>
        </span>
    </td>
    <td><a node='con:edit' href='#' class='itemSmallLink'><img src='img/edit_icon.gif' /></a></td>
    <td><a node='con:delete' href='#' class='itemSmallLink'><img src='img/delete_icon.gif' /></a></td>
    <td><a node='con:cache' href='#' class='itemSmallLink'>2005-12-01</a></td>
    </span>
  </tr>

  <tr node='rep:webItem'>
    <span node='-con:placeHolder'>
    <td><input node='con:checkbox' type='checkbox' name='100' /></td>
    <td>
        <span node='itemDescription' class='itemDescription'>
            <a node='con:itemDescription' href='#' title='MindRetrieve - search your personal web'>this is a long link </a>
        </span>
        <span node='con:itemTag' class='itemTag'>
            <a node='rep:tag' href='#' class='itemSmallLink'>tag1</a>
            <span node="-sep:tag">, </span>
            <a node='rep:tag' href='#' class='itemSmallLink'>tag2</a>
        </span>
    </td>
    <td><a node='con:edit' href='#' class='itemSmallLink'><img src='img/edit_icon.gif' /></a></td>
    <td><a node='con:delete' href='#' class='itemSmallLink'><img src='img/delete_icon.gif' /></a></td>
    <td><a node='con:cache' href='#' class='itemSmallLink'>2005-12-01</a></td>
    </span>
  </tr>

  <tr node='rep:webItem' class='altrow'>
    <span node='-con:placeHolder'>
    <td><input node='con:checkbox' type='checkbox' name='100' /></td>
    <td>
        <span node='itemDescription' class='itemDescription'>
            <a node='con:itemDescription' href='#' title='MindRetrieve - search your personal web'>this is a long link </a>
        </span>
        <span node='con:itemTag' class='itemTag'>
            <a node='rep:tag' href='#' class='itemSmallLink'>tag1</a>
            <span node="-sep:tag">, </span>
            <a node='rep:tag' href='#' class='itemSmallLink'>tag2</a>
        </span>
    </td>
    <td><a node='con:edit' href='#' class='itemSmallLink'><img src='img/edit_icon.gif' /></a></td>
    <td><a node='con:delete' href='#' class='itemSmallLink'><img src='img/delete_icon.gif' /></a></td>
    <td><a node='con:cache' href='#' class='itemSmallLink'>2005-12-01</a></td>
    </span>
  </tr>

  <tr node='rep:webItem'>
    <span node='-con:placeHolder'>
    <td><input node='con:checkbox' type='checkbox' name='100' /></td>
    <td>
        <span node='itemDescription' class='itemDescription'>
            <a node='con:itemDescription' href='#' title='MindRetrieve - search your personal web'>this is a long link </a>
        </span>
        <span node='con:itemTag' class='itemTag'>
            <a node='rep:tag' href='#' class='itemSmallLink'>tag1</a>
            <span node="-sep:tag">, </span>
            <a node='rep:tag' href='#' class='itemSmallLink'>tag2</a>
        </span>
    </td>
    <td><a node='con:edit' href='#' class='itemSmallLink'><img src='img/edit_icon.gif' /></a></td>
    <td><a node='con:delete' href='#' class='itemSmallLink'><img src='img/delete_icon.gif' /></a></td>
    <td><a node='con:cache' href='#' class='itemSmallLink'>2005-12-01</a></td>
    </span>
  </tr>

  <tr class='libTableFooter'>
    <td><input id='checkAll_bottom' type='checkbox' onclick='selectAll("checkAll_bottom")'></td>
    <td colspan='4' align='right'>
       <input type='button' value='Organize' onclick='organizeSelected();' />
       <input type='button' value='Delete'  onclick='deleteSelected();' />
    </td>
  </tr>

  </table>
  </form>

</div>
</td> <!-- itemPane -->

</tr>
</table> <!-- content -->


<!-- hidden asyncForm -->
<form id='asyncForm' action='#' target='asyncFrame' >
<input id='asyncForm.category_collapse' type='textbox' name='category_collapse' />
<iframe id='asyncFrame' src='' scrolling='no' ></iframe>
</form>


<div node='-con:footer' style='width:100%;background-color:#ddd;text-align:center'>--footer--</div>

</body>
</html>
